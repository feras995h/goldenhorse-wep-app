# ุฎุทุฉ ุนูู ููุฒุงููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ุงูููุงุฐุฌ

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 5 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุชูููุฐ

---

## ๐ ููุฎุต ุชูููุฐู

ุชู ุฅุฌุฑุงุก ูุญุต ุดุงูู ููุชูุงูู ุจูู ูููุงุช ุงูููุงุฐุฌ (Models) ููุงุนุฏุฉ ุงูุจูุงูุงุช PostgreSQL. ุงููุชุงุฆุฌ ูุงูุชุงูู:

### ุงูุฅุญุตุงุฆูุงุช ุงูุฑุฆูุณูุฉ
- **ุฅุฌูุงูู ุงูููุงุฐุฌ:** 38
- **ุฅุฌูุงูู ุงูุฌุฏุงูู:** 33
- **ุงูุฌุฏุงูู ุงููุชุทุงุจูุฉ:** 29
- **ุงูุฌุฏุงูู ุงูููููุฏุฉ:** 9
- **ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ:** 4

### ุงููุดุงูู ุงูููุชุดูุฉ
- **๐ด ุญุฑุฌุฉ:** 9 ูุดุงูู (ุฌุฏุงูู ููููุฏุฉ ุชูุงูุงู)
- **๐ ุนุงููุฉ:** 83 ูุดููุฉ (ุญููู ููููุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- **๐ก ูุชูุณุทุฉ:** 89 ูุดููุฉ (ุญููู ููููุฏุฉ ูู ุงูููุงุฐุฌ - timestamps)

---

## ๐ด ุงููุดุงูู ุงูุญุฑุฌุฉ (ุฃููููุฉ ุนุงููุฉ ุฌุฏุงู)

### 1. ุงูุฌุฏุงูู ุงูููููุฏุฉ ุชูุงูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูุฐู ุงูุฌุฏุงูู ููุฌูุฏุฉ ูู ุงูููุงุฐุฌ ูููู ุบูุฑ ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

1. **`accounting_periods`** - ูุชุฑุงุช ูุญุงุณุจูุฉ
2. **`audit_logs`** - ุณุฌูุงุช ุงูุชุฏููู
3. **`company_logo`** - ุดุนุงุฑ ุงูุดุฑูุฉ
4. **`purchase_invoice_payments`** - ุฏูุนุงุช ููุงุชูุฑ ุงูุดุฑุงุก
5. **`sales_invoice_items`** - ุจููุฏ ููุงุชูุฑ ุงููุจูุนุงุช
6. **`sales_invoice_payments`** - ุฏูุนุงุช ููุงุชูุฑ ุงููุจูุนุงุช
7. **`sales_returns`** - ูุฑุชุฌุนุงุช ุงููุจูุนุงุช
8. **`stock_movements`** - ุญุฑูุงุช ุงููุฎุฒูู
9. **`warehouse_release_orders`** - ุฃูุงูุฑ ุงูุฅูุฑุงุฌ ูู ุงููุฎุฒู

**ุงูุชุฃุซูุฑ:** ูุฐู ุงูุฌุฏุงูู ุถุฑูุฑูุฉ ูุนูู ุงููุธุงู ุจุดูู ุตุญูุญ. ุนุฏู ูุฌูุฏูุง ุณูุคุฏู ุฅูู ุฃุฎุทุงุก ูู ุงูุชุทุจูู.

**ุงูุญู:** ุฅูุดุงุก ูููุงุช ูุฌุฑุฉ (migrations) ูุฅูุดุงุก ูุฐู ุงูุฌุฏุงูู.

---

## ๐ ุงููุดุงูู ุงูุนุงููุฉ (ุฃููููุฉ ุนุงููุฉ)

### 2. ุญููู ููููุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูุฐู ุงูุญููู ููุฌูุฏุฉ ูู ุงูููุงุฐุฌ ูููู ููููุฏุฉ ูู ุงูุฌุฏุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

#### **ุฌุฏูู `account_mappings`** (10 ุญููู ููููุฏุฉ)
- `localCustomersAccount`
- `foreignCustomersAccount`
- `discountAccount`
- `shippingRevenueAccount`
- `handlingFeeAccount`
- `customsClearanceAccount`
- `insuranceAccount`
- `storageAccount`
- `createdBy`
- `updatedBy`

#### **ุฌุฏูู `customers`** (5 ุญููู ููููุฏุฉ)
- `accountId`
- `customerType`
- `nationality`
- `passportNumber`
- `residencyStatus`

#### **ุฌุฏูู `employees`** (9 ุญููู ููููุฏุฉ)
- `code`
- `terminationDate`
- `accountId`
- `bankAccount`
- `bankName`
- `taxNumber`
- `emergencyContact`
- `emergencyPhone`
- `notes`

#### **ุฌุฏูู `gl_entries`** (14 ุญูู ููููุฏ)
- `postingDate`, `accountId`, `debit`, `credit`
- `voucherType`, `voucherNo`, `journalEntryId`
- `remarks`, `isCancelled`, `cancelledAt`, `cancelledBy`
- `createdBy`, `currency`, `exchangeRate`

#### **ุฌุฏูู `sales_invoices`** (17 ุญูู ููููุฏ)
- `subtotal`, `discountAmount`, `taxAmount`, `total`
- `currency`, `exchangeRate`, `paymentStatus`, `paymentMethod`
- `invoiceDate`, `postedStatus`, `postedAt`, `postedBy`
- `documentNo`, `fiscalYear`, `canEdit`, `voidReason`, `createdBy`

#### **ุฌุฏูู `receipts`** (11 ุญูู ููููุฏ)
- `receiptNo`, `receiptDate`, `referenceNo`
- `bankAccount`, `checkNumber`, `currency`, `exchangeRate`
- `remarks`, `createdBy`, `completedAt`, `completedBy`

#### **ุฌุฏูู `suppliers`** (6 ุญููู ููููุฏุฉ)
- `city`, `country`, `paymentTerms`
- `currency`, `notes`, `createdBy`

#### **ุฌุฏูู `shipping_invoices`** (6 ุญููู ููููุฏุฉ)
- `invoiceNumber`, `customerId`, `totalAmount`
- `isActive`, `shipmentId`, `outstandingAmount`

**ุงูุชุฃุซูุฑ:** ูุฐู ุงูุญููู ุถุฑูุฑูุฉ ููุธุงุฆู ูุนููุฉ ูู ุงููุธุงู. ุนุฏู ูุฌูุฏูุง ูุฏ ูุณุจุจ ุฃุฎุทุงุก ุนูุฏ ูุญุงููุฉ ุญูุธ ุฃู ูุฑุงุกุฉ ุงูุจูุงูุงุช.

**ุงูุญู:** ุฅูุดุงุก ูููุงุช ูุฌุฑุฉ ูุฅุถุงูุฉ ูุฐู ุงูุญููู ุฅูู ุงูุฌุฏุงูู ุงููุนููุฉ.

---

## ๐ก ุงููุดุงูู ุงููุชูุณุทุฉ (ุฃููููุฉ ูุชูุณุทุฉ)

### 3. ุญููู `createdAt` ู `updatedAt` ููููุฏุฉ ูู ุงูููุงุฐุฌ

ูุนุธู ุงูููุงุฐุฌ ุชูุชูุฏ ุฅูู ุชุนุฑูู ุญููู `createdAt` ู `updatedAt` ุฑุบู ุฃููุง ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

**ุงูุณุจุจ:** Sequelize ูุถูู ูุฐู ุงูุญููู ุชููุงุฆูุงู ุนูุฏ ุชูุนูู `timestamps: true`.

**ุงูุชุฃุซูุฑ:** ููุฎูุถ - ุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ ูุฃู Sequelize ูุชุนุงูู ูุนูุง ุชููุงุฆูุงู.

**ุงูุญู:** 
- **ุงูุฎูุงุฑ 1:** ุฅุถุงูุฉ ุชุนุฑูู ุตุฑูุญ ููุฐู ุงูุญููู ูู ุงูููุงุฐุฌ (ููุตู ุจู ูููุถูุญ)
- **ุงูุฎูุงุฑ 2:** ุชุฑู ุงูุฃูุฑ ููุง ูู (Sequelize ูุชุนุงูู ูุนูุง ุชููุงุฆูุงู)

### 4. ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูุฐู ุงูุฌุฏุงูู ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูููู ูุง ููุฌุฏ ููุง ููุงุฐุฌ:

1. **`invoice_items`** - ุจููุฏ ุงูููุงุชูุฑ
2. **`gl_entry_details`** - ุชูุงุตูู ุงููููุฏ
3. **`vouchers`** - ุงูุณูุฏุงุช
4. **`migrations_log`** - ุณุฌู ุงููุฌุฑุงุช

**ุงูุชุญููู:**
- `migrations_log` - ุฌุฏูู ูุธุงููุ ูุง ูุญุชุงุฌ ูููุฐุฌ
- `invoice_items`, `gl_entry_details`, `vouchers` - ูุฏ ุชููู ุฌุฏุงูู ูุฏููุฉ ุฃู ุจุฏููุฉ

**ุงูุญู:** ูุฑุงุฌุนุฉ ูุฐู ุงูุฌุฏุงูู ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงูุช:
- ุชุญุชุงุฌ ุฅูู ููุงุฐุฌ ุฌุฏูุฏุฉ
- ูุฌุจ ุฏูุฌูุง ูุน ุฌุฏุงูู ุฃุฎุฑู
- ูููู ุญุฐููุง (ุจุนุฏ ุงูุชุฃูุฏ ูู ุนุฏู ุงุณุชุฎุฏุงููุง)

### 5. ุชุนุงุฑุถุงุช ูู ุฃุณูุงุก ุงูุญููู

#### **ุฌุฏูู `shipping_invoices`**
- ุงููููุฐุฌ ูุณุชุฎุฏู: `invoiceNumber`, `customerId`, `totalAmount` (camelCase)
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุณุชุฎุฏู: `invoice_number`, `customer_id`, `total_amount` (snake_case)

**ุงูุญู:** ุชูุญูุฏ ููุท ุงูุชุณููุฉ (ููุถู snake_case ูู PostgreSQL)

#### **ุฌุฏูู `purchase_invoices`**
- ุงููููุฐุฌ ูุณุชุฎุฏู: `outstandingAmount` (camelCase)
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุณุชุฎุฏู: `outstandingamount` (lowercase)

**ุงูุญู:** ุชุตุญูุญ ุงุณู ุงูุนููุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐ ุฎุทุฉ ุงูุนูู ุงูููุชุฑุญุฉ

### ุงููุฑุญูุฉ 1: ุฅุตูุงุญ ุงููุดุงูู ุงูุญุฑุฌุฉ (ุฃููููุฉ ุนุงููุฉ ุฌุฏุงู)

#### ุงูุฎุทูุฉ 1.1: ุฅูุดุงุก ุงูุฌุฏุงูู ุงูููููุฏุฉ

```bash
# ุฅูุดุงุก ูููุงุช ุงููุฌุฑุฉ ููุฌุฏุงูู ุงูููููุฏุฉ
node scripts/create-migration.js create-accounting-periods
node scripts/create-migration.js create-audit-logs
node scripts/create-migration.js create-company-logo
node scripts/create-migration.js create-purchase-invoice-payments
node scripts/create-migration.js create-sales-invoice-items
node scripts/create-migration.js create-sales-invoice-payments
node scripts/create-migration.js create-sales-returns
node scripts/create-migration.js create-stock-movements
node scripts/create-migration.js create-warehouse-release-orders
```

**ุงูููุช ุงูููุฏุฑ:** 4-6 ุณุงุนุงุช

---

### ุงููุฑุญูุฉ 2: ุฅุตูุงุญ ุงููุดุงูู ุงูุนุงููุฉ (ุฃููููุฉ ุนุงููุฉ)

#### ุงูุฎุทูุฉ 2.1: ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ุฅูู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ

ุฅูุดุงุก ููู ูุฌุฑุฉ ูุงุญุฏ ุดุงูู ูุฅุถุงูุฉ ุฌููุน ุงูุญููู ุงูููููุฏุฉ:

```bash
node scripts/create-migration.js add-missing-fields-to-existing-tables
```

**ุงูุฌุฏุงูู ุงููุชุฃุซุฑุฉ:**
- `account_mappings` (10 ุญููู)
- `customers` (5 ุญููู)
- `employees` (9 ุญููู)
- `gl_entries` (14 ุญูู)
- `sales_invoices` (17 ุญูู)
- `receipts` (11 ุญูู)
- `suppliers` (6 ุญููู)
- `shipping_invoices` (6 ุญููู)
- `fixed_assets` (1 ุญูู)
- `invoices` (3 ุญููู)
- `purchase_invoices` (1 ุญูู)

**ุงูููุช ุงูููุฏุฑ:** 3-4 ุณุงุนุงุช

---

### ุงููุฑุญูุฉ 3: ุฅุตูุงุญ ุงููุดุงูู ุงููุชูุณุทุฉ (ุฃููููุฉ ูุชูุณุทุฉ)

#### ุงูุฎุทูุฉ 3.1: ุชุญุฏูุซ ุงูููุงุฐุฌ ูุฅุถุงูุฉ timestamps

ุชุญุฏูุซ ุฌููุน ุงูููุงุฐุฌ ูุฅุถุงูุฉ ุชุนุฑูู ุตุฑูุญ ูู `createdAt` ู `updatedAt`:

```javascript
createdAt: {
  type: DataTypes.DATE,
  allowNull: false,
  defaultValue: DataTypes.NOW
},
updatedAt: {
  type: DataTypes.DATE,
  allowNull: false,
  defaultValue: DataTypes.NOW
}
```

**ุงูููุช ุงูููุฏุฑ:** 2-3 ุณุงุนุงุช

#### ุงูุฎุทูุฉ 3.2: ุญู ุชุนุงุฑุถุงุช ุฃุณูุงุก ุงูุญููู

1. **`shipping_invoices`**: ุฅูุดุงุก ูุฌุฑุฉ ูุฅุนุงุฏุฉ ุชุณููุฉ ุงูุฃุนูุฏุฉ
2. **`purchase_invoices`**: ุชุตุญูุญ `outstandingamount` ุฅูู `outstanding_amount`
3. **`gl_entries`**: ูุฑุงุฌุนุฉ ุงูุจููุฉ ุงููุงููุฉ ููุฌุฏูู

**ุงูููุช ุงูููุฏุฑ:** 2-3 ุณุงุนุงุช

#### ุงูุฎุทูุฉ 3.3: ูุฑุงุฌุนุฉ ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ

- ูุญุต ุงุณุชุฎุฏุงู `invoice_items`, `gl_entry_details`, `vouchers`
- ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงูุช ุชุญุชุงุฌ ููุงุฐุฌ ุฃู ูููู ุญุฐููุง
- ุชูุซูู ุงููุฑุงุฑ

**ุงูููุช ุงูููุฏุฑ:** 1-2 ุณุงุนุฉ

---

## ๐๏ธ ุงูุฃุฏูุงุช ูุงูุณูุฑูุจุชุงุช ุงููุทููุจุฉ

### 1. ุณูุฑูุจุช ุฅูุดุงุก ุงูุฌุฏุงูู ุงูููููุฏุฉ

```bash
# ุณูุชู ุฅูุดุงุก ููู migration ุดุงูู
node scripts/create-missing-tables-migration.js
```

### 2. ุณูุฑูุจุช ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ

```bash
# ุณูุชู ุฅูุดุงุก ููู migration ูุฅุถุงูุฉ ุฌููุน ุงูุญููู ุงูููููุฏุฉ
node scripts/create-missing-fields-migration.js
```

### 3. ุณูุฑูุจุช ุงูุชุญูู ูู ุงููุฒุงููุฉ

```bash
# ุชุดุบูู ุงููุญุต ูุฑุฉ ุฃุฎุฑู ุจุนุฏ ุงูุชุทุจูู
node comprehensive-database-check.js
```

---

## โ๏ธ ุชุญุฐูุฑุงุช ูููุงุญุธุงุช ูููุฉ

### ูุจู ุชูููุฐ ุฃู ูุฌุฑุฉ:

1. **ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุงููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**
   ```bash
   pg_dump -U postgres -d golden_horse > backup_$(date +%Y%m%d_%H%M%S).sql
   ```

2. **ุงุฎุชุจุงุฑ ุงููุฌุฑุงุช ุนูู ุจูุฆุฉ ุชุทููุฑ ุฃููุงู**
   - ูุง ุชุทุจู ุงููุฌุฑุงุช ูุจุงุดุฑุฉ ุนูู ุงูุฅูุชุงุฌ
   - ุงุฎุชุจุฑ ูู ูุฌุฑุฉ ุนูู ุญุฏุฉ

3. **ูุฑุงุฌุนุฉ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ**
   - ุจุนุถ ุงูุญููู ุงูุฌุฏูุฏุฉ ูุฏ ุชุญุชุงุฌ ููู ุงูุชุฑุงุถูุฉ
   - ุชุฃูุฏ ูู ุฃู ุงูุญููู `NOT NULL` ููุง ููู ุงูุชุฑุงุถูุฉ ููุงุณุจุฉ

4. **ุงูุชูุณูู ูุน ุงููุฑูู**
   - ุฃุจูุบ ุงููุฑูู ูุจู ุชุทุจูู ุงููุฌุฑุงุช
   - ุฎุทุท ูููุช ุชููู (downtime) ุฅุฐุง ูุฒู ุงูุฃูุฑ

---

## ๐ ูุคุดุฑุงุช ุงููุฌุงุญ

ุจุนุฏ ุชูููุฐ ุฌููุน ุงูุฅุตูุงุญุงุชุ ูุฌุจ ุฃู ุชููู ุงููุชุงุฆุฌ:

- โ **0 ุฌุฏุงูู ููููุฏุฉ**
- โ **0 ูุดุงูู ุญุฑุฌุฉ**
- โ **ุฃูู ูู 10 ูุดุงูู ุนุงููุฉ** (ููุท timestamps)
- โ **ุฌููุน ุงููุธุงุฆู ุชุนูู ุจุฏูู ุฃุฎุทุงุก**

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ูุฑุงุฌุนุฉ ูุฐู ุงูุฎุทุฉ** ูุน ุงููุฑูู
2. **ุงูููุงููุฉ ุนูู ุงูุฎุทุฉ** ูุชุญุฏูุฏ ููุนุฏ ุงูุชูููุฐ
3. **ุฅูุดุงุก ูููุงุช ุงููุฌุฑุฉ** ุงููุทููุจุฉ
4. **ุงุฎุชุจุงุฑ ุงููุฌุฑุงุช** ุนูู ุจูุฆุฉ ุงูุชุทููุฑ
5. **ุชุทุจูู ุงููุฌุฑุงุช** ุนูู ุงูุฅูุชุงุฌ
6. **ุงูุชุญูู ูู ุงููุชุงุฆุฌ** ุจุงุณุชุฎุฏุงู ุณูุฑูุจุช ุงููุญุต

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### ุงูุฃููููุงุช ุงูููุตู ุจูุง:

1. **ููุฑู (ุฎูุงู 24 ุณุงุนุฉ):**
   - ุฅูุดุงุก ุงูุฌุฏุงูู ุงูููููุฏุฉ ุงูุญุฑุฌุฉ: `accounting_periods`, `audit_logs`
   - ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ูู `sales_invoices` ู `gl_entries`

2. **ุนุงุฌู (ุฎูุงู ุฃุณุจูุน):**
   - ุฅูุดุงุก ุจุงูู ุงูุฌุฏุงูู ุงูููููุฏุฉ
   - ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ูู ุจุงูู ุงูุฌุฏุงูู

3. **ููู (ุฎูุงู ุฃุณุจูุนูู):**
   - ุชุญุฏูุซ ุงูููุงุฐุฌ ูุฅุถุงูุฉ timestamps
   - ุญู ุชุนุงุฑุถุงุช ุฃุณูุงุก ุงูุญููู

4. **ุงุฎุชูุงุฑู (ุนูุฏ ุงูุญุงุฌุฉ):**
   - ูุฑุงุฌุนุฉ ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ
   - ุชุญุณูู ูุชูุซูู ุงูุจููุฉ

---

**ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ุจูุงุณุทุฉ:** ุณูุฑูุจุช ุงููุญุต ุงูุดุงูู `comprehensive-database-check.js`  
**ุงูุชูุฑูุฑ ุงูุชูุตููู:** `DATABASE_COMPATIBILITY_REPORT.md`  
**ุงูุชูุฑูุฑ JSON:** `DATABASE_COMPATIBILITY_REPORT.json`
