#!/bin/bash

# ุณูุฑููพุช ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ุงูุดุงููุฉ
# ูููู ุชุดุบููู ุนูู ุงูุจูุฆุฉ ุงููุญููุฉ ุฃู VPS

echo "๐ ุจุฏุก ุงูุงุฎุชุจุงุฑ ุงูุดุงูู ูููุธุงู..."
echo "=================================="

# ุชุญุฏูุฏ ุงูุจูุฆุฉ
ENVIRONMENT=${1:-local}

if [ "$ENVIRONMENT" = "vps" ]; then
    echo "๐ ุงุฎุชุจุงุฑ ุงูุจูุฆุฉ: VPS (ุงูุฅูุชุงุฌ)"
    echo "๐ ุงูุฑุงุจุท: https://web.goldenhorse-ly.com"
elif [ "$ENVIRONMENT" = "local" ]; then
    echo "๐ ุงุฎุชุจุงุฑ ุงูุจูุฆุฉ: ุงููุญููุฉ"
    echo "๐ ุงูุฑุงุจุท: http://localhost:3001"
else
    echo "โ ุจูุฆุฉ ุบูุฑ ุตุญูุญุฉ. ุงุณุชุฎุฏู: local ุฃู vps"
    exit 1
fi

echo ""

# ุงูุชุญูู ูู ูุฌูุฏ Node.js
if ! command -v node &> /dev/null; then
    echo "โ Node.js ุบูุฑ ูุซุจุช"
    exit 1
fi

# ุงูุชุญูู ูู ูุฌูุฏ ููู ุงูุงุฎุชุจุงุฑ
if [ ! -f "comprehensive-system-test.js" ]; then
    echo "โ ููู ุงูุงุฎุชุจุงุฑ ุบูุฑ ููุฌูุฏ: comprehensive-system-test.js"
    exit 1
fi

# ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช
echo "๐งช ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช..."
node comprehensive-system-test.js $ENVIRONMENT

# ุงูุชุญูู ูู ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ
if [ $? -eq 0 ]; then
    echo ""
    echo "โ ุชู ุฅููุงู ุงูุงุฎุชุจุงุฑุงุช ุจูุฌุงุญ"
    echo "๐ ุฑุงุฌุน ุงููุชุงุฆุฌ ุฃุนูุงู ููุชูุงุตูู"
else
    echo ""
    echo "โ ูุดู ูู ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช"
    echo "๐ ุฑุงุฌุน ุงูุฃุฎุทุงุก ุฃุนูุงู"
    exit 1
fi

echo ""
echo "๐ฏ ุงูุชูู ุงูุงุฎุชุจุงุฑ"
echo "=================================="
